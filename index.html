<!DOCTYPE html>

<html>
<head>
    <title>AudioContext</title>
    <style>
        .control-group label{
            display: block
        }
        .control-group input{
            width: 100%;
        }
        .control-group input[type=number]{
            width: 20%;
        }
        canvas{
            width: 500px;
            height: 100px;
        }
    </style>
</head>

<body>
<form>
    <fieldset id='filter1'>
        <legend>Filter 1</legend>
        <div class='control-group'>
            <label for='filter1frequency'>Filter Frequency</label>
            <input type='range' min='1' max='8' step='0.001' value='8' id='filter1frequency'>
        </div>
        <div class='control-group'>
            <label for='filter1Q'>Filter Q</label>
            <input type='number' min='0.0001' max='1000' step='0.0001' value='0.0001' id='filter1Q'>
        </div>
        <div class='control-group'>
            <label for='filter1Gain'>Filter Gain</label>
            <input type='range' min='-40' max='40' value='0' id='filter1Gain'>
        </div>
        <div class='control-group'>
            <label for='filter1Type'>Filter Type</label>
            <select id='filter1Type'>
                <option value='lowpass'>Low Pass</option>
                <option value='bandpass'>Band Pass</option>
                <option value='highpass'>High Pass</option>
                <option value='lowshelf'>Low Shelf</option>
                <option value='highshelf'>High Shelf</option>
                <option value='peaking'>Peaking</option>
                <option value='notch'>Notch</option>
                <option value='allpass'>All Pass</option>
            </select>
        </div>
    </fieldset>
    <fieldset id='oscillators'>
        
        <legend>Oscillators</legend>
        <div class='control-group'>
            <label for='oscillator1Octave'>Osc1 Frequency</label>
            <input type='range' min='1' max='8' step='0.001' value='2' id='oscillator1Octave'>
        </div>
        <div class='control-group'>
            <label for='oscillator2Detune'>Osc2 Detune</label>
            <input type='range' min='-100' max='100' value='0' id='oscillator2Detune'>
        </div>
        <div class='control-group'>
            <label for='oscillator2Octave'>Osc2 Octave</label>
            <input type='range' min='-2' max='2' step='1' value='-1' id='oscillator2Octave'>
        </div>
        <div class='control-group'>
            <label for='oscillator1Type'>Osc1 Waveform</label>
            <select id='oscillator1Type'>
                <option value='sine'>Sine</option>
                <option value='square'>Square</option>
                <option value='sawtooth'>Sawtooth</option>
                <option value='triangle'>Triangle</option>
            </select>
        </div>
        <div class='control-group'>
            <label for='oscillator2Type'>Osc2 Waveform</label>
            <select id='oscillator2Type'>
                <option value='sine'>Sine</option>
                <option value='square'>Square</option>
                <option value='sawtooth'>Sawtooth</option>
                <option value='triangle'>Triangle</option>
            </select>
        </div>
    </fieldset>
    <div id='oscilliscope'>
        <canvas id='oscilliscopeVisualiser'></canvas>
    </div>
    <button type='button' id='dualOscillatorsOn'>Start</button>
    <button type='button' id='dualOscillatorsOff'>Stop</button>
    <button type='button' id='captureWaveform'>Capture waveform</button>
</form>
<script src='js/require.js' data-main='js/application'></script>
<script type='text/javascript'>
    document.querySelector('#filter1frequency').addEventListener('change', function(event){
        filter1.frequency.value = Math.pow(2, event.target.value) * 55;
    });
    document.querySelector('#filter1Q').addEventListener('change', function(event){
        filter1.Q.value = event.target.value;
    });
    document.querySelector('#filter1Gain').addEventListener('change', function(event){
        filter1.gain.value = event.target.value;
    });
    document.querySelector('#filter1Type').addEventListener('change', function(event){
        filter1.type = event.target.value;
    });
    document.querySelector('#oscillator1Octave').addEventListener('change', function(event){
        osc1.frequency.value = Math.pow(2, event.target.value) * 55;
        osc2.frequency.value = osc1.frequency.value * Math.pow(2, document.querySelector('#oscillator2Octave').value);
        console.log(event.target.value, osc1.frequency.value, osc2.frequency.value)
    });
    document.querySelector('#oscillator2Detune').addEventListener('change', function(event){
        osc2.detune.value = event.target.value;
    });
    document.querySelector('#oscillator2Octave').addEventListener('change', function(event){
        osc2.frequency.value = osc1.frequency.value * Math.pow(2, event.target.value);
    });
    document.querySelector('#oscillator1Type').addEventListener('change', function(event){
        osc1.type = event.target.value;
    });
    document.querySelector('#oscillator2Type').addEventListener('change', function(event){
        osc2.type = event.target.value;
    });
    document.querySelector('#filter1Type').addEventListener('change', function(event){
        filter1.type = event.target.value;
    });    
    document.querySelector('#dualOscillatorsOn').addEventListener('click', function(event){
        playOscillators(0);
    });
    document.querySelector('#dualOscillatorsOff').addEventListener('click', function(event){
        osc1.stop(0);
        osc2.stop(0);
    });
    document.querySelector('#captureWaveform').addEventListener('click', function(event){
        drawWaveform();
    });
    document.querySelector('form').addEventListener('submit', function(event){
        event && event.preventDefault()    
    })
</script>
</body>
</html>
